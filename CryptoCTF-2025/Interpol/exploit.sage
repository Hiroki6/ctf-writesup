#!/usr/bin/env sage

from sage.all import loads

with open("output.raw", "rb") as f:
    poly = loads(f.read())

flag_length = 53

flag_char = ['?'] * flag_length
for n in range(flag_length):
    x_val = -(1 + (19*n - 14) % flag_length)
    y_val = poly(x_val)
    if y_val in ZZ and 32 <= y_val <= 126:
        pos = (63 * n - 40) % flag_length
        flag_char[pos] = chr(y_val)
flag = ''.join(flag_char)
print("Flag:", flag)
